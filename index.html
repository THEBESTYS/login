<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A-Shop 사용자 관리 시스템</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <style>
        :root {
            --bronze: #cd7f32;
            --silver: #c0c0c0;
            --gold: #ffd700;
            --platinum: #e5e4e2;
            --diamond: #b9f2ff;
        }
        
        body {
            background-color: #f8f9fa;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        .navbar-brand {
            font-weight: 700;
            color: #0d6efd;
        }
        
        .tier-badge {
            padding: 4px 10px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.8rem;
            text-transform: uppercase;
        }
        
        .tier-bronze {
            background-color: var(--bronze);
            color: white;
        }
        
        .tier-silver {
            background-color: var(--silver);
            color: #333;
        }
        
        .tier-gold {
            background-color: var(--gold);
            color: #333;
        }
        
        .tier-platinum {
            background-color: var(--platinum);
            color: #333;
        }
        
        .tier-diamond {
            background-color: var(--diamond);
            color: #333;
        }
        
        .status-active {
            color: #198754;
        }
        
        .status-inactive {
            color: #dc3545;
        }
        
        .user-card {
            transition: transform 0.2s, box-shadow 0.2s;
            cursor: pointer;
        }
        
        .user-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .stat-card {
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            color: white;
            text-align: center;
        }
        
        .stat-total {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .stat-active {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }
        
        .stat-premium {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }
        
        .detail-panel {
            background-color: white;
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 0 20px rgba(0,0,0,0.08);
            height: 100%;
        }
        
        .detail-section {
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eee;
        }
        
        .detail-label {
            font-weight: 600;
            color: #555;
            margin-bottom: 5px;
        }
        
        .detail-value {
            font-size: 1.1rem;
        }
        
        .method-badge {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
        }
        
        .method-email {
            background-color: #e3f2fd;
            color: #1565c0;
        }
        
        .method-github {
            background-color: #333;
            color: white;
        }
        
        .search-box {
            position: relative;
        }
        
        .search-box i {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #6c757d;
        }
        
        .search-box input {
            padding-left: 45px;
        }
        
        .filter-btn.active {
            background-color: #0d6efd;
            color: white;
        }
        
        .points-display {
            font-weight: 700;
            color: #0d6efd;
            font-size: 1.2rem;
        }
        
        .verified-badge {
            color: #198754;
            font-size: 0.9rem;
        }
        
        .not-verified-badge {
            color: #dc3545;
            font-size: 0.9rem;
        }
        
        .last-login {
            font-size: 0.85rem;
            color: #6c757d;
        }
    </style>
</head>
<body>
    <!-- 네비게이션 바 -->
    <nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm mb-4">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">
                <i class="bi bi-shop me-2"></i>A-Shop 사용자 관리 시스템
            </a>
            <div class="d-flex align-items-center">
                <span class="me-3 text-muted">관리자</span>
                <div class="dropdown">
                    <button class="btn btn-outline-secondary dropdown-toggle" type="button" id="adminMenu" data-bs-toggle="dropdown">
                        <i class="bi bi-person-circle"></i>
                    </button>
                    <ul class="dropdown-menu">
                        <li><a class="dropdown-item" href="#"><i class="bi bi-gear me-2"></i>설정</a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li><a class="dropdown-item" href="#"><i class="bi bi-box-arrow-right me-2"></i>로그아웃</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <!-- 왼쪽 사이드바: 통계 및 필터 -->
            <div class="col-lg-3 mb-4">
                <!-- 통계 카드 -->
                <div class="row">
                    <div class="col-12">
                        <div class="stat-card stat-total">
                            <h4>총 사용자</h4>
                            <h2 class="mb-0" id="totalUsers">0</h2>
                            <p class="mb-0 mt-2">전체 등록 사용자</p>
                        </div>
                    </div>
                    <div class="col-12">
                        <div class="stat-card stat-active">
                            <h4>활성 사용자</h4>
                            <h2 class="mb-0" id="activeUsers">0</h2>
                            <p class="mb-0 mt-2">최근 30일 로그인</p>
                        </div>
                    </div>
                    <div class="col-12">
                        <div class="stat-card stat-premium">
                            <h4>프리미엄 등급</h4>
                            <h2 class="mb-0" id="premiumUsers">0</h2>
                            <p class="mb-0 mt-2">골드 이상 등급</p>
                        </div>
                    </div>
                </div>
                
                <!-- 검색 및 필터 -->
                <div class="card mb-4">
                    <div class="card-body">
                        <h5 class="card-title mb-3"><i class="bi bi-search me-2"></i>사용자 검색</h5>
                        
                        <div class="search-box mb-3">
                            <i class="bi bi-search"></i>
                            <input type="text" class="form-control" id="searchInput" placeholder="이름, 이메일, 전화번호로 검색">
                        </div>
                        
                        <h6 class="mt-4 mb-3"><i class="bi bi-funnel me-2"></i>등급 필터</h6>
                        <div class="d-flex flex-wrap gap-2 mb-3">
                            <button class="btn btn-sm btn-outline-secondary filter-btn active" data-tier="all">전체</button>
                            <button class="btn btn-sm btn-outline-secondary filter-btn" data-tier="bronze">브론즈</button>
                            <button class="btn btn-sm btn-outline-secondary filter-btn" data-tier="silver">실버</button>
                            <button class="btn btn-sm btn-outline-secondary filter-btn" data-tier="gold">골드</button>
                            <button class="btn btn-sm btn-outline-secondary filter-btn" data-tier="platinum">플래티넘</button>
                            <button class="btn btn-sm btn-outline-secondary filter-btn" data-tier="diamond">다이아몬드</button>
                        </div>
                        
                        <h6 class="mt-4 mb-3"><i class="bi bi-filter-circle me-2"></i>상태 필터</h6>
                        <div class="d-flex flex-wrap gap-2">
                            <button class="btn btn-sm btn-outline-secondary status-filter-btn active" data-status="all">전체</button>
                            <button class="btn btn-sm btn-outline-success status-filter-btn" data-status="active">활성</button>
                            <button class="btn btn-sm btn-outline-danger status-filter-btn" data-status="inactive">비활성</button>
                        </div>
                    </div>
                </div>
                
                <!-- 정렬 옵션 -->
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title mb-3"><i class="bi bi-sort-down me-2"></i>정렬 기준</h5>
                        <div class="list-group">
                            <button class="list-group-item list-group-item-action sort-option active" data-sort="recent">
                                <i class="bi bi-clock-history me-2"></i>최근 가입순
                            </button>
                            <button class="list-group-item list-group-item-action sort-option" data-sort="name">
                                <i class="bi bi-sort-alpha-down me-2"></i>이름순
                            </button>
                            <button class="list-group-item list-group-item-action sort-option" data-sort="points">
                                <i class="bi bi-coin me-2"></i>포인트순
                            </button>
                            <button class="list-group-item list-group-item-action sort-option" data-sort="tier">
                                <i class="bi bi-award me-2"></i>등급순
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 중앙 영역: 사용자 목록 -->
            <div class="col-lg-5 mb-4">
                <div class="card">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h5 class="mb-0"><i class="bi bi-people me-2"></i>사용자 목록</h5>
                        <span class="badge bg-primary" id="userCount">0명</span>
                    </div>
                    <div class="card-body p-0">
                        <div id="userList" class="list-group list-group-flush">
                            <!-- 사용자 목록이 여기에 동적으로 생성됩니다 -->
                            <div class="text-center py-5 text-muted" id="loadingUsers">
                                <div class="spinner-border text-primary" role="status">
                                    <span class="visually-hidden">로딩 중...</span>
                                </div>
                                <p class="mt-3">사용자 목록을 불러오는 중입니다...</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 오른쪽 사이드바: 상세 정보 -->
            <div class="col-lg-4 mb-4">
                <div class="detail-panel">
                    <h4 class="mb-4"><i class="bi bi-person-badge me-2"></i>사용자 상세 정보</h4>
                    <div id="userDetail" class="text-center text-muted py-5">
                        <i class="bi bi-person-x display-1 mb-3"></i>
                        <p>왼쪽에서 사용자를 선택해 주세요.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 사용자 목록 템플릿 -->
    <template id="userItemTemplate">
        <div class="list-group-item user-card" data-uid="">
            <div class="row align-items-center">
                <div class="col-auto">
                    <div class="bg-light rounded-circle d-flex align-items-center justify-content-center" style="width: 50px; height: 50px;">
                        <i class="bi bi-person-fill text-secondary" style="font-size: 1.5rem;"></i>
                    </div>
                </div>
                <div class="col">
                    <div class="d-flex justify-content-between align-items-start">
                        <div>
                            <h6 class="mb-1" data-field="displayName"></h6>
                            <p class="mb-1 text-muted small" data-field="email"></p>
                            <div class="d-flex align-items-center mt-2">
                                <span class="tier-badge me-2" data-field="tierBadge"></span>
                                <span class="method-badge me-2" data-field="methodBadge"></span>
                                <span class="last-login" data-field="lastLogin"></span>
                            </div>
                        </div>
                        <div class="text-end">
                            <div class="points-display mb-2" data-field="points"></div>
                            <div>
                                <span class="badge bg-success" data-field="statusBadge"></span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </template>

    <!-- 상세 정보 템플릿 -->
    <template id="userDetailTemplate">
        <div>
            <div class="text-center mb-4">
                <div class="bg-light rounded-circle d-inline-flex align-items-center justify-content-center mb-3" style="width: 80px; height: 80px;">
                    <i class="bi bi-person-fill text-secondary" style="font-size: 2.5rem;"></i>
                </div>
                <h4 data-field="displayName"></h4>
                <p class="text-muted" data-field="email"></p>
                <div class="d-flex justify-content-center gap-2 mb-3">
                    <span class="tier-badge" data-field="tierBadge"></span>
                    <span class="method-badge" data-field="methodBadge"></span>
                </div>
            </div>
            
            <div class="detail-section">
                <h6><i class="bi bi-info-circle me-2"></i>기본 정보</h6>
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <div class="detail-label">사용자 ID</div>
                        <div class="detail-value" data-field="username"></div>
                    </div>
                    <div class="col-md-6 mb-3">
                        <div class="detail-label">전화번호</div>
                        <div class="detail-value" data-field="phone"></div>
                    </div>
                    <div class="col-md-6 mb-3">
                        <div class="detail-label">계정 상태</div>
                        <div class="detail-value" data-field="status"></div>
                    </div>
                    <div class="col-md-6 mb-3">
                        <div class="detail-label">이메일 인증</div>
                        <div class="detail-value" data-field="emailVerified"></div>
                    </div>
                </div>
            </div>
            
            <div class="detail-section">
                <h6><i class="bi bi-coin me-2"></i>포인트 및 등급</h6>
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <div class="detail-label">보유 포인트</div>
                        <div class="detail-value points-display" data-field="points"></div>
                    </div>
                    <div class="col-md-6 mb-3">
                        <div class="detail-label">회원 등급</div>
                        <div class="detail-value" data-field="tier"></div>
                    </div>
                </div>
            </div>
            
            <div class="detail-section">
                <h6><i class="bi bi-bell me-2"></i>마케팅 동의</h6>
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <div class="detail-label">이메일 수신</div>
                        <div class="detail-value" data-field="marketingEmail"></div>
                    </div>
                    <div class="col-md-6 mb-3">
                        <div class="detail-label">SMS 수신</div>
                        <div class="detail-value" data-field="marketingSms"></div>
                    </div>
                </div>
            </div>
            
            <div class="detail-section">
                <h6><i class="bi bi-clock-history me-2"></i>계정 정보</h6>
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <div class="detail-label">가입일</div>
                        <div class="detail-value" data-field="createdAt"></div>
                    </div>
                    <div class="col-md-6 mb-3">
                        <div class="detail-label">마지막 로그인</div>
                        <div class="detail-value" data-field="lastLogin"></div>
                    </div>
                    <div class="col-md-6 mb-3">
                        <div class="detail-label">가입 방법</div>
                        <div class="detail-value" data-field="signupMethod"></div>
                    </div>
                    <div class="col-md-6 mb-3">
                        <div class="detail-label">UID</div>
                        <div class="detail-value small text-truncate" data-field="uid"></div>
                    </div>
                </div>
            </div>
            
            <div class="d-flex gap-2 mt-4">
                <button class="btn btn-primary flex-fill"><i class="bi bi-pencil me-2"></i>정보 수정</button>
                <button class="btn btn-outline-secondary flex-fill"><i class="bi bi-envelope me-2"></i>메시지 보내기</button>
                <button class="btn btn-outline-danger"><i class="bi bi-trash"></i></button>
            </div>
        </div>
    </template>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // 샘플 사용자 데이터 - 실제로는 Firebase에서 가져옵니다
        const sampleUsers = [
            {
                uid: "firebase-uid-001",
                email: "user1@ashop.com",
                username: "user1",
                displayName: "김철수",
                phone: "010-1234-5678",
                tier: "gold",
                points: 5500,
                status: "active",
                signupMethod: "email",
                emailVerified: true,
                marketingAgreed: { email: true, sms: false },
                createdAt: "2023-10-15T10:30:00",
                updatedAt: "2023-11-20T14:25:00",
                lastLogin: "2023-11-25T09:15:00"
            },
            {
                uid: "firebase-uid-002",
                email: "user2@ashop.com",
                username: "user2",
                displayName: "이영희",
                phone: "010-2345-6789",
                tier: "silver",
                points: 2300,
                status: "active",
                signupMethod: "github",
                emailVerified: true,
                marketingAgreed: { email: true, sms: true },
                createdAt: "2023-09-22T11:20:00",
                updatedAt: "2023-11-18T16:40:00",
                lastLogin: "2023-11-22T13:30:00"
            },
            {
                uid: "firebase-uid-003",
                email: "user3@ashop.com",
                username: "user3",
                displayName: "박지성",
                phone: "010-3456-7890",
                tier: "bronze",
                points: 800,
                status: "active",
                signupMethod: "email",
                emailVerified: false,
                marketingAgreed: { email: false, sms: false },
                createdAt: "2023-11-05T15:45:00",
                updatedAt: "2023-11-15T10:20:00",
                lastLogin: "2023-11-15T10:20:00"
            },
            {
                uid: "firebase-uid-004",
                email: "user4@ashop.com",
                username: "user4",
                displayName: "최민수",
                phone: "010-4567-8901",
                tier: "platinum",
                points: 12000,
                status: "active",
                signupMethod: "email",
                emailVerified: true,
                marketingAgreed: { email: true, sms: true },
                createdAt: "2023-08-10T09:15:00",
                updatedAt: "2023-11-24T11:10:00",
                lastLogin: "2023-11-24T11:10:00"
            },
            {
                uid: "firebase-uid-005",
                email: "user5@ashop.com",
                username: "user5",
                displayName: "정수진",
                phone: "010-5678-9012",
                tier: "diamond",
                points: 25000,
                status: "active",
                signupMethod: "github",
                emailVerified: true,
                marketingAgreed: { email: true, sms: false },
                createdAt: "2023-07-18T14:20:00",
                updatedAt: "2023-11-23T17:30:00",
                lastLogin: "2023-11-23T17:30:00"
            },
            {
                uid: "firebase-uid-006",
                email: "user6@ashop.com",
                username: "user6",
                displayName: "윤서연",
                phone: "010-6789-0123",
                tier: "bronze",
                points: 300,
                status: "inactive",
                signupMethod: "email",
                emailVerified: true,
                marketingAgreed: { email: false, sms: false },
                createdAt: "2023-11-01T12:10:00",
                updatedAt: "2023-11-10T09:45:00",
                lastLogin: "2023-11-10T09:45:00"
            },
            {
                uid: "firebase-uid-007",
                email: "user7@ashop.com",
                username: "user7",
                displayName: "홍길동",
                phone: "010-7890-1234",
                tier: "silver",
                points: 1800,
                status: "active",
                signupMethod: "email",
                emailVerified: true,
                marketingAgreed: { email: true, sms: true },
                createdAt: "2023-10-28T16:30:00",
                updatedAt: "2023-11-21T14:15:00",
                lastLogin: "2023-11-21T14:15:00"
            },
            {
                uid: "firebase-uid-008",
                email: "user8@ashop.com",
                username: "user8",
                displayName: "강지민",
                phone: "010-8901-2345",
                tier: "gold",
                points: 7500,
                status: "active",
                signupMethod: "github",
                emailVerified: true,
                marketingAgreed: { email: false, sms: true },
                createdAt: "2023-09-05T13:25:00",
                updatedAt: "2023-11-19T18:20:00",
                lastLogin: "2023-11-19T18:20:00"
            }
        ];

        // 전역 변수
        let allUsers = [...sampleUsers];
        let filteredUsers = [...sampleUsers];
        let currentSort = 'recent';
        let currentTierFilter = 'all';
        let currentStatusFilter = 'all';
        let currentSearch = '';

        // DOM 요소
        const userList = document.getElementById('userList');
        const userDetail = document.getElementById('userDetail');
        const userItemTemplate = document.getElementById('userItemTemplate');
        const userDetailTemplate = document.getElementById('userDetailTemplate');
        const searchInput = document.getElementById('searchInput');
        const totalUsersEl = document.getElementById('totalUsers');
        const activeUsersEl = document.getElementById('activeUsers');
        const premiumUsersEl = document.getElementById('premiumUsers');
        const userCountEl = document.getElementById('userCount');

        // 유틸리티 함수
        function formatDate(dateString) {
            const date = new Date(dateString);
            const now = new Date();
            const diffTime = Math.abs(now - date);
            const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));
            
            if (diffDays === 0) {
                return '오늘';
            } else if (diffDays === 1) {
                return '어제';
            } else if (diffDays < 7) {
                return `${diffDays}일 전`;
            } else {
                return date.toLocaleDateString('ko-KR', {
                    year: 'numeric',
                    month: 'short',
                    day: 'numeric'
                });
            }
        }

        function formatTier(tier) {
            const tierNames = {
                bronze: '브론즈',
                silver: '실버',
                gold: '골드',
                platinum: '플래티넘',
                diamond: '다이아몬드'
            };
            return tierNames[tier] || tier;
        }

        function getTierClass(tier) {
            return `tier-${tier}`;
        }

        function getMethodClass(method) {
            return `method-${method}`;
        }

        // 통계 업데이트
        function updateStatistics() {
            const total = allUsers.length;
            const active = allUsers.filter(user => user.status === 'active').length;
            const premium = allUsers.filter(user => 
                ['gold', 'platinum', 'diamond'].includes(user.tier)
            ).length;
            
            totalUsersEl.textContent = total;
            activeUsersEl.textContent = active;
            premiumUsersEl.textContent = premium;
            userCountEl.textContent = `${filteredUsers.length}명`;
        }

        // 사용자 목록 필터링
        function filterUsers() {
            filteredUsers = allUsers.filter(user => {
                // 등급 필터
                if (currentTierFilter !== 'all' && user.tier !== currentTierFilter) {
                    return false;
                }
                
                // 상태 필터
                if (currentStatusFilter !== 'all' && user.status !== currentStatusFilter) {
                    return false;
                }
                
                // 검색 필터
                if (currentSearch) {
                    const searchLower = currentSearch.toLowerCase();
                    return (
                        user.displayName.toLowerCase().includes(searchLower) ||
                        user.email.toLowerCase().includes(searchLower) ||
                        user.phone.includes(searchLower) ||
                        user.username.toLowerCase().includes(searchLower)
                    );
                }
                
                return true;
            });
            
            // 정렬 적용
            sortUsers();
        }

        // 사용자 정렬
        function sortUsers() {
            switch(currentSort) {
                case 'recent':
                    filteredUsers.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt));
                    break;
                case 'name':
                    filteredUsers.sort((a, b) => a.displayName.localeCompare(b.displayName));
                    break;
                case 'points':
                    filteredUsers.sort((a, b) => b.points - a.points);
                    break;
                case 'tier':
                    const tierOrder = { diamond: 5, platinum: 4, gold: 3, silver: 2, bronze: 1 };
                    filteredUsers.sort((a, b) => tierOrder[b.tier] - tierOrder[a.tier]);
                    break;
            }
        }

        // 사용자 목록 렌더링
        function renderUserList() {
            userList.innerHTML = '';
            
            if (filteredUsers.length === 0) {
                userList.innerHTML = `
                    <div class="text-center py-5 text-muted">
                        <i class="bi bi-people display-4 mb-3"></i>
                        <p>조건에 맞는 사용자가 없습니다.</p>
                    </div>
                `;
                return;
            }
            
            filteredUsers.forEach(user => {
                const template = userItemTemplate.content.cloneNode(true);
                const userCard = template.querySelector('.user-card');
                
                // 데이터 바인딩
                userCard.dataset.uid = user.uid;
                template.querySelector('[data-field="displayName"]').textContent = user.displayName;
                template.querySelector('[data-field="email"]').textContent = user.email;
                template.querySelector('[data-field="points"]').textContent = `${user.points.toLocaleString()} P`;
                
                // 등급 뱃지
                const tierBadge = template.querySelector('[data-field="tierBadge"]');
                tierBadge.textContent = formatTier(user.tier);
                tierBadge.className = `tier-badge ${getTierClass(user.tier)}`;
                
                // 가입 방법 뱃지
                const methodBadge = template.querySelector('[data-field="methodBadge"]');
                methodBadge.textContent = user.signupMethod === 'email' ? '이메일' : 'GitHub';
                methodBadge.className = `method-badge ${getMethodClass(user.signupMethod)}`;
                
                // 상태 뱃지
                const statusBadge = template.querySelector('[data-field="statusBadge"]');
                statusBadge.textContent = user.status === 'active' ? '활성' : '비활성';
                statusBadge.className = user.status === 'active' ? 'badge bg-success' : 'badge bg-danger';
                
                // 마지막 로그인
                const lastLogin = template.querySelector('[data-field="lastLogin"]');
                lastLogin.textContent = `마지막 접속: ${formatDate(user.lastLogin)}`;
                
                // 클릭 이벤트
                userCard.addEventListener('click', () => showUserDetail(user));
                
                userList.appendChild(template);
            });
        }

        // 사용자 상세 정보 표시
        function showUserDetail(user) {
            const template = userDetailTemplate.content.cloneNode(true);
            
            // 기본 정보
            template.querySelector('[data-field="displayName"]').textContent = user.displayName;
            template.querySelector('[data-field="email"]').textContent = user.email;
            template.querySelector('[data-field="username"]').textContent = user.username;
            template.querySelector('[data-field="phone"]').textContent = user.phone;
            template.querySelector('[data-field="uid"]').textContent = user.uid;
            
            // 등급 뱃지
            const tierBadge = template.querySelector('[data-field="tierBadge"]');
            tierBadge.textContent = formatTier(user.tier);
            tierBadge.className = `tier-badge ${getTierClass(user.tier)}`;
            
            // 가입 방법 뱃지
            const methodBadge = template.querySelector('[data-field="methodBadge"]');
            methodBadge.textContent = user.signupMethod === 'email' ? '이메일' : 'GitHub';
            methodBadge.className = `method-badge ${getMethodClass(user.signupMethod)}`;
            
            // 상태
            template.querySelector('[data-field="status"]').innerHTML = 
                user.status === 'active' 
                    ? '<span class="status-active"><i class="bi bi-check-circle-fill me-1"></i>활성</span>'
                    : '<span class="status-inactive"><i class="bi bi-x-circle-fill me-1"></i>비활성</span>';
            
            // 이메일 인증
            template.querySelector('[data-field="emailVerified"]').innerHTML = 
                user.emailVerified
                    ? '<span class="verified-badge"><i class="bi bi-check-circle-fill me-1"></i>인증됨</span>'
                    : '<span class="not-verified-badge"><i class="bi bi-x-circle-fill me-1"></i>미인증</span>';
            
            // 포인트 및 등급
            template.querySelector('[data-field="points"]').textContent = `${user.points.toLocaleString()} P`;
            template.querySelector('[data-field="tier"]').textContent = formatTier(user.tier);
            
            // 마케팅 동의
            template.querySelector('[data-field="marketingEmail"]').innerHTML = 
                user.marketingAgreed.email
                    ? '<span class="verified-badge"><i class="bi bi-check-circle-fill me-1"></i>동의</span>'
                    : '<span class="not-verified-badge"><i class="bi bi-x-circle-fill me-1"></i>비동의</span>';
            
            template.querySelector('[data-field="marketingSms"]').innerHTML = 
                user.marketingAgreed.sms
                    ? '<span class="verified-badge"><i class="bi bi-check-circle-fill me-1"></i>동의</span>'
                    : '<span class="not-verified-badge"><i class="bi bi-x-circle-fill me-1"></i>비동의</span>';
            
            // 계정 정보
            template.querySelector('[data-field="createdAt"]').textContent = formatDate(user.createdAt);
            template.querySelector('[data-field="lastLogin"]').textContent = formatDate(user.lastLogin);
            template.querySelector('[data-field="signupMethod"]').textContent = 
                user.signupMethod === 'email' ? '이메일 가입' : 'GitHub 가입';
            
            userDetail.innerHTML = '';
            userDetail.appendChild(template);
            
            // 활성 사용자 표시
            document.querySelectorAll('.user-card').forEach(card => {
                card.classList.remove('active');
                if (card.dataset.uid === user.uid) {
                    card.classList.add('active');
                    card.style.backgroundColor = '#f0f8ff';
                }
            });
        }

        // 초기화
        function init() {
            // 통계 업데이트
            updateStatistics();
            
            // 초기 사용자 목록 렌더링
            setTimeout(() => {
                filterUsers();
                renderUserList();
            }, 500); // 로딩 효과를 위한 지연
            
            // 검색 이벤트
            searchInput.addEventListener('input', (e) => {
                currentSearch = e.target.value;
                filterUsers();
                renderUserList();
            });
            
            // 등급 필터 이벤트
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    currentTierFilter = btn.dataset.tier;
                    filterUsers();
                    renderUserList();
                });
            });
            
            // 상태 필터 이벤트
            document.querySelectorAll('.status-filter-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('.status-filter-btn').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    currentStatusFilter = btn.dataset.status;
                    filterUsers();
                    renderUserList();
                });
            });
            
            // 정렬 옵션 이벤트
            document.querySelectorAll('.sort-option').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('.sort-option').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    currentSort = btn.dataset.sort;
                    filterUsers();
                    renderUserList();
                });
            });
            
            // 첫 번째 사용자 선택 (데모용)
            setTimeout(() => {
                if (filteredUsers.length > 0) {
                    showUserDetail(filteredUsers[0]);
                }
            }, 600);
        }

        // 페이지 로드 시 초기화
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
