<!DOCTYPE html>
<html>
<head>
    <title>Firestore ë°ì´í„° í…ŒìŠ¤íŠ¸</title>
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore-compat.js"></script>
</head>
<body>
    <h1>ashop Firestore í…ŒìŠ¤íŠ¸</h1>
    
    <div style="padding: 20px; background: #f5f5f5; border-radius: 10px;">
        <button onclick="loadFirestoreData()" 
                style="padding: 10px 20px; background: #4285f4; color: white; border: none; border-radius: 5px; font-size: 16px;">
            ğŸ” Firestoreì—ì„œ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
        </button>
        
        <button onclick="addNewUser()" 
                style="padding: 10px 20px; background: #34a853; color: white; border: none; border-radius: 5px; font-size: 16px; margin-left: 10px;">
            â• ìƒˆ ì‚¬ìš©ì ì¶”ê°€í•˜ê¸°
        </button>
    </div>
    
    <div id="result" style="margin-top: 20px; padding: 20px; background: white; border-radius: 5px; border: 1px solid #ddd;">
        ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤...
    </div>

    <script>
        // Firebase ì„¤ì • (ê¸°ì¡´ê³¼ ë™ì¼)
        const firebaseConfig = {
            apiKey: "AIzaSyC1XDqgki7lKMz-EE4ZFzOLmku8EsLI0yI",
            authDomain: "login-57c14.firebaseapp.com",
            projectId: "login-57c14",
            storageBucket: "login-57c14.firebasestorage.app",
            messagingSenderId: "847658526472",
            appId: "1:847658526472:web:05adaddfea3afff8e12ebd"
        };

        // Firebase ì´ˆê¸°í™”
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        
        console.log("Firestore ì¤€ë¹„ ì™„ë£Œ");

        // ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° í•¨ìˆ˜
        async function loadFirestoreData() {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = '<p>ë°ì´í„° ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>';
            
            try {
                // Firestoreì—ì„œ ë¬¸ì„œ ë¶ˆëŸ¬ì˜¤ê¸°
                const docRef = db.collection('ashop_users').doc('test_user_001');
                const doc = await docRef.get();
                
                if (doc.exists) {
                    const data = doc.data();
                    
                    // ê²°ê³¼ í‘œì‹œ
                    resultDiv.innerHTML = `
                        <h2>âœ… Firestore ì—°ê²° ì„±ê³µ!</h2>
                        <div style="background: #e8f5e9; padding: 15px; border-radius: 5px;">
                            <h3>ì‚¬ìš©ì ì •ë³´:</h3>
                            <p><strong>ì´ë¦„:</strong> ${data.name}</p>
                            <p><strong>ì´ë©”ì¼:</strong> ${data.ì´ë©”ì¼}</p>
                            <p><strong>í•¸ë“œí°:</strong> ${data['í•¸ë“œí° ë²ˆí˜¸'] || 'ì—†ìŒ'}</p>
                            <p><strong>ê°€ì…ì¼:</strong> ${data.ê°€ì…ì¼?.toDate?.().toLocaleString() || 'ì—†ìŒ'}</p>
                        </div>
                        <hr>
                        <h4>ì›ì‹œ ë°ì´í„°:</h4>
                        <pre style="background: #f6f8fa; padding: 10px; border-radius: 5px; overflow: auto;">
${JSON.stringify(data, null, 2)}
                        </pre>
                    `;
                    
                    console.log('ë¶ˆëŸ¬ì˜¨ ë°ì´í„°:', data);
                    
                } else {
                    resultDiv.innerHTML = '<p style="color: red;">âŒ ë¬¸ì„œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>';
                }
                
            } catch (error) {
                resultDiv.innerHTML = `<p style="color: red;">âŒ ì—ëŸ¬ ë°œìƒ: ${error.message}</p>`;
                console.error('Firestore ì—ëŸ¬:', error);
            }
        }

        // ìƒˆ ì‚¬ìš©ì ì¶”ê°€ í•¨ìˆ˜
        async function addNewUser() {
            const userName = prompt('ìƒˆ ì‚¬ìš©ì ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”:', 'ê¹€ì˜í¬');
            if (!userName) return;
            
            const userEmail = prompt('ì´ë©”ì¼ì„ ì…ë ¥í•˜ì„¸ìš”:', 'kim@ashop.com');
            if (!userEmail) return;
            
            try {
                // ìƒˆ ë¬¸ì„œ ì¶”ê°€ (ìë™ ID ìƒì„±)
                const newUserRef = await db.collection('ashop_users').add({
                    name: userName,
                    ì´ë©”ì¼: userEmail,
                    "í•¸ë“œí° ë²ˆí˜¸": "010-0000-0000",
                    ê°€ì…ì¼: firebase.firestore.FieldValue.serverTimestamp(),
                    tier: "bronze",
                    points: 1000,
                    status: "active"
                });
                
                alert(`âœ… ìƒˆ ì‚¬ìš©ì ì¶”ê°€ ì™„ë£Œ!\në¬¸ì„œ ID: ${newUserRef.id}`);
                console.log('ìƒˆ ì‚¬ìš©ì ID:', newUserRef.id);
                
            } catch (error) {
                alert(`âŒ ì¶”ê°€ ì‹¤íŒ¨: ${error.message}`);
                console.error('ì¶”ê°€ ì—ëŸ¬:', error);
            }
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ Firestore ìƒíƒœ í™•ì¸
        document.addEventListener('DOMContentLoaded', () => {
            console.log('í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ, Firestore ì‚¬ìš© ê°€ëŠ¥');
        });
    </script>
</body>
</html>
