

<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A-Shop 사용자 관리 대시보드</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <style>
        :root {
            --bronze: #cd7f32;
            --silver: #c0c0c0;
            --gold: #ffd700;
            --platinum: #e5e4e2;
            --diamond: #b9f2ff;
        }
        
        body {
            background-color: #f8f9fa;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        .dashboard-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px 0;
            margin-bottom: 30px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        
        .stats-card {
            border-radius: 10px;
            padding: 20px;
            color: white;
            margin-bottom: 20px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .stats-total {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .stats-active {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }
        
        .stats-premium {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
        }
        
        .stats-points {
            background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
        }
        
        .user-table-container {
            background: white;
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            margin-bottom: 30px;
        }
        
        .tier-badge {
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.8rem;
            text-transform: uppercase;
            display: inline-block;
        }
        
        .tier-bronze {
            background-color: var(--bronze);
            color: white;
        }
        
        .tier-silver {
            background-color: var(--silver);
            color: #333;
        }
        
        .tier-gold {
            background-color: var(--gold);
            color: #333;
        }
        
        .tier-platinum {
            background-color: var(--platinum);
            color: #333;
        }
        
        .tier-diamond {
            background-color: var(--diamond);
            color: #333;
        }
        
        .status-badge {
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
        }
        
        .status-active {
            background-color: #d4edda;
            color: #155724;
        }
        
        .status-inactive {
            background-color: #f8d7da;
            color: #721c24;
        }
        
        .method-badge {
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
        }
        
        .method-email {
            background-color: #e3f2fd;
            color: #1565c0;
        }
        
        .method-github {
            background-color: #333;
            color: white;
        }
        
        .search-box {
            position: relative;
        }
        
        .search-box i {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #6c757d;
        }
        
        .search-box input {
            padding-left: 45px;
        }
        
        .filter-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 15px;
        }
        
        .filter-btn {
            padding: 8px 16px;
            border: 2px solid #dee2e6;
            border-radius: 20px;
            background: white;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .filter-btn:hover, .filter-btn.active {
            background: #0d6efd;
            color: white;
            border-color: #0d6efd;
        }
        
        .table-hover tbody tr:hover {
            background-color: #f8f9fa;
            cursor: pointer;
        }
        
        .user-detail-panel {
            background: white;
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            height: 100%;
        }
        
        .detail-section {
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eee;
        }
        
        .detail-label {
            font-weight: 600;
            color: #555;
            margin-bottom: 5px;
            font-size: 0.9rem;
        }
        
        .detail-value {
            font-size: 1rem;
        }
        
        .points-display {
            font-weight: 700;
            color: #0d6efd;
            font-size: 1.1rem;
        }
        
        .action-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        
        .btn-action {
            flex: 1;
        }
        
        .pagination .page-link {
            border-radius: 5px;
            margin: 0 3px;
        }
        
        .data-structure-panel {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 25px;
            margin-top: 30px;
            border-left: 4px solid #667eea;
        }
        
        .code-block {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            margin-top: 15px;
        }
    </style>
</head>
<body>
    <!-- 대시보드 헤더 -->
    <div class="dashboard-header">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-8">
                    <h1><i class="bi bi-people-fill me-2"></i>A-Shop 사용자 관리 대시보드</h1>
                    <p class="mb-0">ashop_users 컬렉션 데이터 관리 및 모니터링</p>
                </div>
                <div class="col-md-4 text-end">
                    <div class="dropdown">
                        <button class="btn btn-light dropdown-toggle" type="button" id="adminMenu" data-bs-toggle="dropdown">
                            <i class="bi bi-person-circle me-2"></i>관리자
                        </button>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="#"><i class="bi bi-gear me-2"></i>설정</a></li>
                            <li><a class="dropdown-item" href="#"><i class="bi bi-download me-2"></i>데이터 내보내기</a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item" href="#"><i class="bi bi-box-arrow-right me-2"></i>로그아웃</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- 통계 카드 -->
        <div class="row mb-4">
            <div class="col-md-3">
                <div class="stats-card stats-total">
                    <h5><i class="bi bi-people me-2"></i>총 사용자</h5>
                    <h2 class="mb-0">1,254</h2>
                    <p class="mb-0 mt-2">전체 등록 사용자 수</p>
                </div>
            </div>
            <div class="col-md-3">
                <div class="stats-card stats-active">
                    <h5><i class="bi bi-check-circle me-2"></i>활성 사용자</h5>
                    <h2 class="mb-0">1,089</h2>
                    <p class="mb-0 mt-2">최근 30일 로그인</p>
                </div>
            </div>
            <div class="col-md-3">
                <div class="stats-card stats-premium">
                    <h5><i class="bi bi-award me-2"></i>프리미엄 등급</h5>
                    <h2 class="mb-0">356</h2>
                    <p class="mb-0 mt-2">골드 이상 등급</p>
                </div>
            </div>
            <div class="col-md-3">
                <div class="stats-card stats-points">
                    <h5><i class="bi bi-coin me-2"></i>총 포인트</h5>
                    <h2 class="mb-0">2.4M</h2>
                    <p class="mb-0 mt-2">누적 보유 포인트</p>
                </div>
            </div>
        </div>

        <div class="row">
            <!-- 왼쪽: 사용자 테이블 -->
            <div class="col-lg-8">
                <div class="user-table-container">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h4><i class="bi bi-table me-2"></i>사용자 목록</h4>
                        <div class="search-box">
                            <i class="bi bi-search"></i>
                            <input type="text" class="form-control" id="searchInput" placeholder="이름, 이메일, 전화번호 검색" style="width: 250px;">
                        </div>
                    </div>
                    
                    <!-- 필터 버튼 -->
                    <div class="filter-buttons mb-4">
                        <button class="filter-btn active" data-filter="all">전체</button>
                        <button class="filter-btn" data-filter="bronze">브론즈</button>
                        <button class="filter-btn" data-filter="silver">실버</button>
                        <button class="filter-btn" data-filter="gold">골드</button>
                        <button class="filter-btn" data-filter="platinum">플래티넘</button>
                        <button class="filter-btn" data-filter="diamond">다이아몬드</button>
                        <button class="filter-btn" data-filter="active">활성</button>
                        <button class="filter-btn" data-filter="inactive">비활성</button>
                    </div>
                    
                    <!-- 사용자 테이블 -->
                    <div class="table-responsive">
                        <table class="table table-hover">
                            <thead>
                                <tr>
                                    <th>사용자</th>
                                    <th>등급</th>
                                    <th>포인트</th>
                                    <th>상태</th>
                                    <th>가입일</th>
                                    <th>마지막 로그인</th>
                                </tr>
                            </thead>
                            <tbody id="userTableBody">
                                <!-- 데이터가 동적으로 로드됩니다 -->
                            </tbody>
                        </table>
                    </div>
                    
                    <!-- 페이지네이션 -->
                    <nav aria-label="Page navigation" class="mt-4">
                        <ul class="pagination justify-content-center">
                            <li class="page-item disabled">
                                <a class="page-link" href="#" tabindex="-1">이전</a>
                            </li>
                            <li class="page-item active"><a class="page-link" href="#">1</a></li>
                            <li class="page-item"><a class="page-link" href="#">2</a></li>
                            <li class="page-item"><a class="page-link" href="#">3</a></li>
                            <li class="page-item">
                                <a class="page-link" href="#">다음</a>
                            </li>
                        </ul>
                    </nav>
                </div>
            </div>
            
            <!-- 오른쪽: 상세 정보 -->
            <div class="col-lg-4">
                <div class="user-detail-panel">
                    <h4 class="mb-4"><i class="bi bi-person-badge me-2"></i>사용자 상세 정보</h4>
                    <div id="userDetailContent" class="text-center text-muted py-5">
                        <i class="bi bi-person-x display-4 mb-3"></i>
                        <p>테이블에서 사용자를 선택해 주세요</p>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 데이터 구조 표시 -->
        <div class="data-structure-panel">
            <h4><i class="bi bi-code-slash me-2"></i>ashop_users 컬렉션 문서 구조</h4>
            <p class="text-muted mb-3">Firestore에 저장되는 사용자 데이터의 구조입니다.</p>
            <div class="code-block">
<pre>{
  "uid": "firebase-auth-uid",
  "email": "user@ashop.com",
  "username": "사용자이름",
  "displayName": "사용자이름", 
  "phone": "010-1234-5678",
  "tier": "bronze | silver | gold | platinum | diamond",
  "points": 1000,
  "status": "active | inactive",
  "signupMethod": "email | github",
  "emailVerified": true | false,
  "marketingAgreed": { 
    "email": true | false, 
    "sms": true | false 
  },
  "createdAt": "Timestamp",
  "updatedAt": "Timestamp", 
  "lastLogin": "Timestamp"
}</pre>
            </div>
        </div>
    </div>

    <!-- 사용자 데이터 템플릿 -->
    <template id="userRowTemplate">
        <tr data-uid="">
            <td>
                <div class="d-flex align-items-center">
                    <div class="bg-light rounded-circle d-flex align-items-center justify-content-center me-3" style="width: 40px; height: 40px;">
                        <i class="bi bi-person text-secondary"></i>
                    </div>
                    <div>
                        <div class="fw-bold" data-field="displayName"></div>
                        <div class="text-muted small" data-field="email"></div>
                        <div class="text-muted small" data-field="phone"></div>
                    </div>
                </div>
            </td>
            <td>
                <span class="tier-badge" data-field="tierBadge"></span>
                <div class="small text-muted mt-1" data-field="signupMethodBadge"></div>
            </td>
            <td>
                <div class="points-display" data-field="points"></div>
            </td>
            <td>
                <span class="status-badge" data-field="statusBadge"></span>
                <div class="small text-muted mt-1" data-field="emailVerifiedBadge"></div>
            </td>
            <td>
                <div data-field="createdAt"></div>
            </td>
            <td>
                <div data-field="lastLogin"></div>
                <div class="small text-muted" data-field="lastLoginTime"></div>
            </td>
        </tr>
    </template>
    
    <!-- 상세 정보 템플릿 -->
    <template id="userDetailTemplate">
        <div>
            <div class="text-center mb-4">
                <div class="bg-light rounded-circle d-inline-flex align-items-center justify-content-center mb-3" style="width: 80px; height: 80px;">
                    <i class="bi bi-person-fill text-secondary" style="font-size: 2.5rem;"></i>
                </div>
                <h4 data-field="displayName"></h4>
                <p class="text-muted" data-field="email"></p>
                <div class="d-flex justify-content-center gap-2 mb-3">
                    <span class="tier-badge" data-field="tierBadge"></span>
                    <span class="status-badge" data-field="statusBadge"></span>
                </div>
            </div>
            
            <div class="detail-section">
                <h6><i class="bi bi-info-circle me-2"></i>기본 정보</h6>
                <div class="row">
                    <div class="col-6 mb-3">
                        <div class="detail-label">사용자명</div>
                        <div class="detail-value" data-field="username"></div>
                    </div>
                    <div class="col-6 mb-3">
                        <div class="detail-label">전화번호</div>
                        <div class="detail-value" data-field="phone"></div>
                    </div>
                    <div class="col-6 mb-3">
                        <div class="detail-label">가입 방법</div>
                        <div class="detail-value" data-field="signupMethod"></div>
                    </div>
                    <div class="col-6 mb-3">
                        <div class="detail-label">이메일 인증</div>
                        <div class="detail-value" data-field="emailVerified"></div>
                    </div>
                </div>
            </div>
            
            <div class="detail-section">
                <h6><i class="bi bi-award me-2"></i>포인트 및 등급</h6>
                <div class="row">
                    <div class="col-6 mb-3">
                        <div class="detail-label">보유 포인트</div>
                        <div class="detail-value points-display" data-field="points"></div>
                    </div>
                    <div class="col-6 mb-3">
                        <div class="detail-label">회원 등급</div>
                        <div class="detail-value" data-field="tier"></div>
                    </div>
                </div>
            </div>
            
            <div class="detail-section">
                <h6><i class="bi bi-bell me-2"></i>마케팅 동의</h6>
                <div class="row">
                    <div class="col-6 mb-3">
                        <div class="detail-label">이메일 수신</div>
                        <div class="detail-value" data-field="marketingEmail"></div>
                    </div>
                    <div class="col-6 mb-3">
                        <div class="detail-label">SMS 수신</div>
                        <div class="detail-value" data-field="marketingSms"></div>
                    </div>
                </div>
            </div>
            
            <div class="detail-section">
                <h6><i class="bi bi-clock-history me-2"></i>계정 정보</h6>
                <div class="row">
                    <div class="col-6 mb-3">
                        <div class="detail-label">가입일</div>
                        <div class="detail-value" data-field="createdAtFull"></div>
                    </div>
                    <div class="col-6 mb-3">
                        <div class="detail-label">마지막 로그인</div>
                        <div class="detail-value" data-field="lastLoginFull"></div>
                    </div>
                </div>
            </div>
            
            <div class="action-buttons">
                <button class="btn btn-primary btn-action"><i class="bi bi-pencil me-2"></i>수정</button>
                <button class="btn btn-outline-secondary btn-action"><i class="bi bi-envelope me-2"></i>메시지</button>
                <button class="btn btn-outline-danger"><i class="bi bi-trash"></i></button>
            </div>
        </div>
    </template>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // 샘플 사용자 데이터
        const sampleUsers = [
            {
                uid: "firebase-uid-001",
                email: "kimchulsu@ashop.com",
                username: "chulssu",
                displayName: "김철수",
                phone: "010-1234-5678",
                tier: "gold",
                points: 5500,
                status: "active",
                signupMethod: "email",
                emailVerified: true,
                marketingAgreed: { email: true, sms: false },
                createdAt: "2023-10-15T10:30:00",
                updatedAt: "2023-11-20T14:25:00",
                lastLogin: "2023-11-25T09:15:00"
            },
            {
                uid: "firebase-uid-002",
                email: "lee.younghee@ashop.com",
                username: "younghee",
                displayName: "이영희",
                phone: "010-2345-6789",
                tier: "silver",
                points: 2300,
                status: "active",
                signupMethod: "github",
                emailVerified: true,
                marketingAgreed: { email: true, sms: true },
                createdAt: "2023-09-22T11:20:00",
                updatedAt: "2023-11-18T16:40:00",
                lastLogin: "2023-11-22T13:30:00"
            },
            {
                uid: "firebase-uid-003",
                email: "parkjisung@ashop.com",
                username: "jisung",
                displayName: "박지성",
                phone: "010-3456-7890",
                tier: "bronze",
                points: 800,
                status: "active",
                signupMethod: "email",
                emailVerified: false,
                marketingAgreed: { email: false, sms: false },
                createdAt: "2023-11-05T15:45:00",
                updatedAt: "2023-11-15T10:20:00",
                lastLogin: "2023-11-15T10:20:00"
            },
            {
                uid: "firebase-uid-004",
                email: "choiminsu@ashop.com",
                username: "minsu",
                displayName: "최민수",
                phone: "010-4567-8901",
                tier: "platinum",
                points: 12000,
                status: "active",
                signupMethod: "email",
                emailVerified: true,
                marketingAgreed: { email: true, sms: true },
                createdAt: "2023-08-10T09:15:00",
                updatedAt: "2023-11-24T11:10:00",
                lastLogin: "2023-11-24T11:10:00"
            },
            {
                uid: "firebase-uid-005",
                email: "jungsujin@ashop.com",
                username: "sujin",
                displayName: "정수진",
                phone: "010-5678-9012",
                tier: "diamond",
                points: 25000,
                status: "active",
                signupMethod: "github",
                emailVerified: true,
                marketingAgreed: { email: true, sms: false },
                createdAt: "2023-07-18T14:20:00",
                updatedAt: "2023-11-23T17:30:00",
                lastLogin: "2023-11-23T17:30:00"
            },
            {
                uid: "firebase-uid-006",
                email: "yoonseoyeon@ashop.com",
                username: "seoyeon",
                displayName: "윤서연",
                phone: "010-6789-0123",
                tier: "bronze",
                points: 300,
                status: "inactive",
                signupMethod: "email",
                emailVerified: true,
                marketingAgreed: { email: false, sms: false },
                createdAt: "2023-11-01T12:10:00",
                updatedAt: "2023-11-10T09:45:00",
                lastLogin: "2023-11-10T09:45:00"
            },
            {
                uid: "firebase-uid-007",
                email: "honggildong@ashop.com",
                username: "gildong",
                displayName: "홍길동",
                phone: "010-7890-1234",
                tier: "silver",
                points: 1800,
                status: "active",
                signupMethod: "email",
                emailVerified: true,
                marketingAgreed: { email: true, sms: true },
                createdAt: "2023-10-28T16:30:00",
                updatedAt: "2023-11-21T14:15:00",
                lastLogin: "2023-11-21T14:15:00"
            },
            {
                uid: "firebase-uid-008",
                email: "kangjimin@ashop.com",
                username: "jimin",
                displayName: "강지민",
                phone: "010-8901-2345",
                tier: "gold",
                points: 7500,
                status: "active",
                signupMethod: "github",
                emailVerified: true,
                marketingAgreed: { email: false, sms: true },
                createdAt: "2023-09-05T13:25:00",
                updatedAt: "2023-11-19T18:20:00",
                lastLogin: "2023-11-19T18:20:00"
            }
        ];

        // 전역 변수
        let currentUsers = [...sampleUsers];
        let currentFilter = 'all';
        let currentSearch = '';

        // DOM 요소
        const userTableBody = document.getElementById('userTableBody');
        const userDetailContent = document.getElementById('userDetailContent');
        const userRowTemplate = document.getElementById('userRowTemplate');
        const userDetailTemplate = document.getElementById('userDetailTemplate');
        const searchInput = document.getElementById('searchInput');
        const filterButtons = document.querySelectorAll('.filter-btn');

        // 유틸리티 함수
        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('ko-KR', {
                year: 'numeric',
                month: 'short',
                day: 'numeric'
            });
        }

        function formatDateTime(dateString) {
            const date = new Date(dateString);
            return date.toLocaleString('ko-KR', {
                year: 'numeric',
                month: 'short',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
        }

        function formatTimeAgo(dateString) {
            const date = new Date(dateString);
            const now = new Date();
            const diffMs = now - date;
            const diffDays = Math.floor(diffMs / (1000 * 60 * 60 * 24));
            
            if (diffDays === 0) {
                return '오늘';
            } else if (diffDays === 1) {
                return '어제';
            } else if (diffDays < 7) {
                return `${diffDays}일 전`;
            } else if (diffDays < 30) {
                return `${Math.floor(diffDays / 7)}주 전`;
            } else {
                return formatDate(dateString);
            }
        }

        function formatTier(tier) {
            const tierMap = {
                bronze: '브론즈',
                silver: '실버',
                gold: '골드',
                platinum: '플래티넘',
                diamond: '다이아몬드'
            };
            return tierMap[tier] || tier;
        }

        function getTierClass(tier) {
            return `tier-badge tier-${tier}`;
        }

        // 사용자 테이블 렌더링
        function renderUserTable() {
            userTableBody.innerHTML = '';
            
            currentUsers.forEach(user => {
                const template = userRowTemplate.content.cloneNode(true);
                const row = template.querySelector('tr');
                
                // 데이터 바인딩
                row.dataset.uid = user.uid;
                template.querySelector('[data-field="displayName"]').textContent = user.displayName;
                template.querySelector('[data-field="email"]').textContent = user.email;
                template.querySelector('[data-field="phone"]').textContent = user.phone;
                template.querySelector('[data-field="points"]').textContent = `${user.points.toLocaleString()} P`;
                
                // 등급 뱃지
                const tierBadge = template.querySelector('[data-field="tierBadge"]');
                tierBadge.textContent = formatTier(user.tier);
                tierBadge.className = getTierClass(user.tier);
                
                // 가입 방법 뱃지
                const signupMethodBadge = template.querySelector('[data-field="signupMethodBadge"]');
                signupMethodBadge.textContent = user.signupMethod === 'email' ? '이메일 가입' : 'GitHub 가입';
                signupMethodBadge.className = user.signupMethod === 'email' ? 'method-badge method-email' : 'method-badge method-github';
                
                // 상태 뱃지
                const statusBadge = template.querySelector('[data-field="statusBadge"]');
                statusBadge.textContent = user.status === 'active' ? '활성' : '비활성';
                statusBadge.className = user.status === 'active' ? 'status-badge status-active' : 'status-badge status-inactive';
                
                // 이메일 인증 뱃지
                const emailVerifiedBadge = template.querySelector('[data-field="emailVerifiedBadge"]');
                emailVerifiedBadge.textContent = user.emailVerified ? '이메일 인증됨' : '이메일 미인증';
                emailVerifiedBadge.style.color = user.emailVerified ? '#198754' : '#dc3545';
                
                // 날짜
                template.querySelector('[data-field="createdAt"]').textContent = formatDate(user.createdAt);
                template.querySelector('[data-field="lastLogin"]').textContent = formatDate(user.lastLogin);
                template.querySelector('[data-field="lastLoginTime"]').textContent = formatTimeAgo(user.lastLogin);
                
                // 클릭 이벤트
                row.addEventListener('click', () => showUserDetail(user));
                
                userTableBody.appendChild(template);
            });
        }

        // 사용자 상세 정보 표시
        function showUserDetail(user) {
            const template = userDetailTemplate.content.cloneNode(true);
            
            // 기본 정보
            template.querySelector('[data-field="displayName"]').textContent = user.displayName;
            template.querySelector('[data-field="email"]').textContent = user.email;
            template.querySelector('[data-field="username"]').textContent = user.username;
            template.querySelector('[data-field="phone"]').textContent = user.phone;
            
            // 등급 뱃지
            const tierBadge = template.querySelector('[data-field="tierBadge"]');
            tierBadge.textContent = formatTier(user.tier);
            tierBadge.className = getTierClass(user.tier);
            
            // 상태 뱃지
            const statusBadge = template.querySelector('[data-field="statusBadge"]');
            statusBadge.textContent = user.status === 'active' ? '활성' : '비활성';
            statusBadge.className = user.status === 'active' ? 'status-badge status-active' : 'status-badge status-inactive';
            
            // 가입 방법
            template.querySelector('[data-field="signupMethod"]').textContent = 
                user.signupMethod === 'email' ? '이메일 가입' : 'GitHub 가입';
            
            // 이메일 인증
            template.querySelector('[data-field="emailVerified"]').innerHTML = 
                user.emailVerified 
                    ? '<span style="color:#198754;"><i class="bi bi-check-circle-fill me-1"></i>인증됨</span>'
                    : '<span style="color:#dc3545;"><i class="bi bi-x-circle-fill me-1"></i>미인증</span>';
            
            // 포인트 및 등급
            template.querySelector('[data-field="points"]').textContent = `${user.points.toLocaleString()} P`;
            template.querySelector('[data-field="tier"]').textContent = formatTier(user.tier);
            
            // 마케팅 동의
            template.querySelector('[data-field="marketingEmail"]').innerHTML = 
                user.marketingAgreed.email
                    ? '<span style="color:#198754;"><i class="bi bi-check-circle-fill me-1"></i>동의</span>'
                    : '<span style="color:#dc3545;"><i class="bi bi-x-circle-fill me-1"></i>비동의</span>';
            
            template.querySelector('[data-field="marketingSms"]').innerHTML = 
                user.marketingAgreed.sms
                    ? '<span style="color:#198754;"><i class="bi bi-check-circle-fill me-1"></i>동의</span>'
                    : '<span style="color:#dc3545;"><i class="bi bi-x-circle-fill me-1"></i>비동의</span>';
            
            // 계정 정보
            template.querySelector('[data-field="createdAtFull"]').textContent = formatDateTime(user.createdAt);
            template.querySelector('[data-field="lastLoginFull"]').textContent = formatDateTime(user.lastLogin);
            
            userDetailContent.innerHTML = '';
            userDetailContent.appendChild(template);
            
            // 테이블 행 강조
            document.querySelectorAll('#userTableBody tr').forEach(row => {
                row.classList.remove('table-active');
                if (row.dataset.uid === user.uid) {
                    row.classList.add('table-active');
                }
            });
        }

        // 사용자 필터링
        function filterUsers() {
            currentUsers = sampleUsers.filter(user => {
                // 검색 필터
                if (currentSearch) {
                    const searchLower = currentSearch.toLowerCase();
                    const searchFields = [
                        user.displayName,
                        user.email,
                        user.phone,
                        user.username
                    ];
                    
                    if (!searchFields.some(field => field.toLowerCase().includes(searchLower))) {
                        return false;
                    }
                }
                
                // 상태/등급 필터
                if (currentFilter !== 'all') {
                    if (['active', 'inactive'].includes(currentFilter)) {
                        return user.status === currentFilter;
                    } else if (['bronze', 'silver', 'gold', 'platinum', 'diamond'].includes(currentFilter)) {
                        return user.tier === currentFilter;
                    }
                }
                
                return true;
            });
            
            renderUserTable();
        }

        // 초기화
        function init() {
            // 초기 렌더링
            renderUserTable();
            
            // 첫 번째 사용자 선택 (데모용)
            if (currentUsers.length > 0) {
                showUserDetail(currentUsers[0]);
            }
            
            // 검색 이벤트
            searchInput.addEventListener('input', (e) => {
                currentSearch = e.target.value;
                filterUsers();
            });
            
            // 필터 버튼 이벤트
            filterButtons.forEach(btn => {
                btn.addEventListener('click', () => {
                    filterButtons.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    currentFilter = btn.dataset.filter;
                    filterUsers();
                });
            });
            
            // 페이지 로드 시 통계 업데이트 (가상 데이터)
            updateStats();
        }

        // 통계 업데이트 (가상 데이터)
        function updateStats() {
            // 실제 구현에서는 API 호출을 통해 데이터를 가져옵니다
            console.log('통계 데이터 업데이트 완료');
        }

        // 페이지 로드 시 초기화
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
